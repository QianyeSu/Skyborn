/* Custom CSS for Sphinx Book Theme - Blue theme with animations */

/* ========== Theme Color Configuration ========== */
:root {
    --primary-color: #2563eb;      /* Primary blue */
    --secondary-color: #1e40af;    /* Deep blue */
    --accent-color: #3b82f6;       /* Bright blue */
    --light-blue: #dbeafe;         /* Light blue background */
    --dark-blue: #1e3a8a;          /* Dark blue */
    --gradient-blue: linear-gradient(135deg, #2563eb, #3b82f6);
    --gradient-blue-deep: linear-gradient(135deg, #1e40af 0%, #2563eb 50%, #3b82f6 100%);
    --gradient-blue-light: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 50%, #93c5fd 100%);
    --shadow-blue: rgba(37, 99, 235, 0.3);
    --shadow-blue-light: rgba(37, 99, 235, 0.15);
    --shadow-blue-hover: rgba(37, 99, 235, 0.5);
}

/* ========== Main Page Container Styles ========== */
.bd-main .bd-content .bd-article-container {
    background: var(--gradient-blue-light);
    border-radius: 12px;
    padding: 2rem;
    box-shadow: 0 8px 30px var(--shadow-blue-light),
                0 2px 8px rgba(0, 0, 0, 0.1);
    position: relative;
    overflow: visible; /* Fix: allow content overflow */
}

.bd-main .bd-content .bd-article-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--gradient-blue-deep);
    z-index: 1;
}

/* ========== 导航栏样式 ========== */
.bd-header {
    background: var(--gradient-blue-deep) !important;
    border-bottom: 3px solid var(--dark-blue);
    transition: all 0.3s ease;
    box-shadow: 0 4px 20px var(--shadow-blue);
}

.bd-header:hover {
    transform: translateY(-1px);
    box-shadow: 0 8px 35px var(--shadow-blue-hover);
}

/* ========== 头部按钮区域对齐 ========== */
.bd-header-article {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    min-height: 60px;
    padding: 0.5rem 1rem;
}

.header-article-items {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
}

.header-article-items__start,
.header-article-items__end {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.header-article-items__end {
    margin-left: auto;
}

/* 文章头部按钮区域 */
.article-header-buttons {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

/* 所有头部按钮的通用样式 */
.article-header-buttons .btn,
.article-header-buttons .dropdown-toggle {
    background: transparent !important;
    border: none !important;
    border-radius: 8px !important;
    color: white !important;
    padding: 0.5rem 0.8rem !important;
    font-size: 0.9rem !important;
    transition: all 0.3s ease !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    text-decoration: none !important;
    height: 40px !important;
    min-height: 40px !important;
    min-width: 40px !important;
    width: auto !important;
    white-space: nowrap !important;
}

.article-header-buttons .btn:hover,
.article-header-buttons .dropdown-toggle:hover {
    background: rgba(255, 255, 255, 0.1) !important;
    transform: translateY(-2px) !important;
    color: white !important;
}

/* 主题切换按钮特殊样式 */
.theme-switch-button {
    background: transparent !important;
    border: none !important;
    border-radius: 8px !important;
    color: white !important;
    padding: 0.5rem 0.8rem !important;
    font-size: 0.9rem !important;
    transition: all 0.3s ease !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    text-decoration: none !important;
    height: 40px !important;
    min-height: 40px !important;
    min-width: 40px !important;
    width: auto !important;
    white-space: nowrap !important;
}

.theme-switch-button:hover {
    background: rgba(255, 255, 255, 0.1) !important;
    transform: translateY(-2px) !important;
    color: white !important;
}

/* 确保按钮图标颜色正确 */
.article-header-buttons .btn i,
.article-header-buttons .dropdown-toggle i,
.theme-switch-button i {
    color: white !important;
}

/* 隐藏下拉菜单中的特定按钮 */
.dropdown-source-buttons .btn-source-file-button,
.dropdown-source-buttons .btn-source-edit-button {
    display: none !important;
}

/* 确保所有头部按钮垂直对齐 */
.bd-navbar,
.bd-navbar .navbar-nav,
.bd-header .navbar-nav {
    display: flex;
    align-items: center;
    height: 100%;
}

/* ========== 侧边栏样式 ========== */
.bd-sidebar-primary {
    background: var(--gradient-blue-light);
    border-right: 3px solid white;
    box-shadow: 4px 0 15px var(--shadow-blue-light);
    position: relative;
}

.bd-sidebar-primary::before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 3px;
    height: 100%;
    background: white;
    z-index: 1;
}

.bd-sidebar-primary .bd-sidebar {
    background: transparent;
}

/* 侧边栏所有文字加粗 */
.bd-sidebar-primary,
.bd-sidebar-primary a,
.bd-sidebar-primary .toctree-l1 > a,
.bd-sidebar-primary .toctree-l2 > a,
.bd-sidebar-primary .caption,
.bd-sidebar-primary .caption-text,
.bd-sidebar-primary li,
.bd-sidebar-primary p,
.bd-sidebar-primary span {
    font-weight: 700 !important; /* 使用更粗的字体 */
}

/* 侧边栏链接悬停效果 */
.bd-sidebar-primary .toctree-l1 > a {
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border-radius: 8px;
    margin: 4px 8px;
    padding: 8px 16px;
    position: relative;
    overflow: hidden;
}

.bd-sidebar-primary .toctree-l1 > a::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: var(--gradient-blue);
    transition: left 0.4s ease;
    z-index: -1;
}

.bd-sidebar-primary .toctree-l1 > a:hover::before {
    left: 0;
}

.bd-sidebar-primary .toctree-l1 > a:hover {
    color: white !important;
    transform: translateX(8px) scale(1.02);
    box-shadow: 0 6px 20px var(--shadow-blue);
}

/* ========== Notebook图片优化 ========== */
.nboutput img,
.cell_output img {
    max-width: 85% !important;
    height: auto !important;
    display: block !important;
    margin: 1.5rem auto !important;
    border: 3px solid var(--light-blue);
    border-radius: 16px;
    padding: 15px;
    background: var(--gradient-blue-light);
    box-shadow: 0 10px 40px var(--shadow-blue-light),
                0 4px 15px rgba(0, 0, 0, 0.1);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    cursor: pointer;
}

.nboutput img::before,
.cell_output img::before {
    content: '';
    position: absolute;
    top: -3px;
    left: -3px;
    right: -3px;
    bottom: -3px;
    background: var(--gradient-blue-deep);
    border-radius: 16px;
    z-index: -1;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.nboutput img:hover::before,
.cell_output img:hover::before {
    opacity: 1;
}

.nboutput img:hover,
.cell_output img:hover {
    transform: scale(1.03) translateY(-5px);
    box-shadow: 0 20px 60px var(--shadow-blue),
                0 8px 25px rgba(0, 0, 0, 0.15);
    border-color: var(--primary-color);
}

/* ========== 通用图片样式 - 应用notebook图片效果到所有图片 ========== */
/* 排除notebook图片，因为它们已经有特定样式 */
img:not(.nboutput img):not(.cell_output img):not(.bd-header img):not(.bd-sidebar img) {
    max-width: 90% !important;
    height: auto !important;
    display: block !important;
    margin: 1.5rem auto !important;
    border: 3px solid var(--light-blue);
    border-radius: 16px;
    padding: 15px;
    background: var(--gradient-blue-light);
    box-shadow: 0 10px 40px var(--shadow-blue-light),
                0 4px 15px rgba(0, 0, 0, 0.1);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    cursor: pointer;
}

/* 通用图片的悬停前景效果 */
img:not(.nboutput img):not(.cell_output img):not(.bd-header img):not(.bd-sidebar img)::before {
    content: '';
    position: absolute;
    top: -3px;
    left: -3px;
    right: -3px;
    bottom: -3px;
    background: var(--gradient-blue-deep);
    border-radius: 16px;
    z-index: -1;
    opacity: 0;
    transition: opacity 0.3s ease;
}

/* 通用图片的悬停效果 */
img:not(.nboutput img):not(.cell_output img):not(.bd-header img):not(.bd-sidebar img):hover::before {
    opacity: 1;
}

img:not(.nboutput img):not(.cell_output img):not(.bd-header img):not(.bd-sidebar img):hover {
    transform: scale(1.03) translateY(-5px);
    box-shadow: 0 20px 60px var(--shadow-blue),
                0 8px 25px rgba(0, 0, 0, 0.15);
    border-color: var(--primary-color);
}

/* 特殊处理：文档中的图片 */
.bd-content img,
.bd-article img,
article img,
.document img {
    max-width: 90% !important;
    height: auto !important;
    display: block !important;
    margin: 1.5rem auto !important;
    border: 3px solid var(--light-blue);
    border-radius: 16px;
    padding: 15px;
    background: var(--gradient-blue-light);
    box-shadow: 0 10px 40px var(--shadow-blue-light),
                0 4px 15px rgba(0, 0, 0, 0.1);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    cursor: pointer;
}

.bd-content img::before,
.bd-article img::before,
article img::before,
.document img::before {
    content: '';
    position: absolute;
    top: -3px;
    left: -3px;
    right: -3px;
    bottom: -3px;
    background: var(--gradient-blue-deep);
    border-radius: 16px;
    z-index: -1;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.bd-content img:hover::before,
.bd-article img:hover::before,
article img:hover::before,
.document img:hover::before {
    opacity: 1;
}

.bd-content img:hover,
.bd-article img:hover,
article img:hover,
.document img:hover {
    transform: scale(1.03) translateY(-5px);
    box-shadow: 0 20px 60px var(--shadow-blue),
                0 8px 25px rgba(0, 0, 0, 0.15);
    border-color: var(--primary-color);
}

/* 排除小图标和装饰性图片 */
.bd-header img,
.bd-sidebar img,
.bd-footer img,
img[width="16"],
img[width="20"],
img[width="24"],
img[width="32"],
img[height="16"],
img[height="20"],
img[height="24"],
img[height="32"],
.icon img,
.logo img {
    border: none !important;
    border-radius: 0 !important;
    padding: 0 !important;
    background: none !important;
    box-shadow: none !important;
    transition: none !important;
    cursor: default !important;
    margin: 0 !important;
    max-width: none !important;
    display: inline !important;
}

/* 图片说明文字样式 */
.figure-caption,
.caption,
figcaption {
    text-align: center !important;
    font-style: italic !important;
    color: var(--secondary-color) !important;
    margin-top: 1rem !important;
    font-size: 0.9em !important;
}

/* ========== 代码块样式 ========== */
.nbinput .highlight pre,
.nboutput .highlight pre,
.cell_input .highlight pre,
.cell_output .highlight pre {
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%) !important;
    border-left: 4px solid var(--primary-color);
    border-radius: 12px;
    padding: 1.5rem;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 4px 15px var(--shadow-blue-light),
                0 2px 8px rgba(0, 0, 0, 0.05);
    position: relative;
    overflow: hidden;
}

.nbinput .highlight pre::before,
.cell_input .highlight pre::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--gradient-blue-deep);
    transform: scaleY(0);
    transform-origin: bottom;
    transition: transform 0.3s ease;
}

.nbinput .highlight pre:hover::before,
.cell_input .highlight pre:hover::before {
    transform: scaleY(1);
}

.nbinput .highlight pre:hover,
.cell_input .highlight pre:hover {
    transform: translateX(8px) translateY(-2px);
    box-shadow: 0 8px 30px var(--shadow-blue),
                0 4px 15px rgba(0, 0, 0, 0.1);
}

/* 输入单元格：蓝色主题 */
.cell_input {
    background: var(--gradient-blue-light);
    border-left: 4px solid var(--primary-color);
    border-radius: 12px;
    margin-bottom: 1rem;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 4px 15px var(--shadow-blue-light);
    position: relative;
    overflow: hidden;
}

.cell_input::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    transition: left 0.6s ease;
}

.cell_input:hover::before {
    left: 100%;
}

.cell_input:hover {
    transform: translateY(-4px) scale(1.01);
    box-shadow: 0 12px 40px var(--shadow-blue),
                0 6px 20px rgba(0, 0, 0, 0.1);
}

/* 输出单元格：蓝绿色主题 */
.cell_output {
    background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 50%, #a7f3d0 100%);
    border-left: 4px solid #10b981;
    border-radius: 12px;
    margin-bottom: 1.2rem;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 4px 15px rgba(16, 185, 129, 0.2);
    position: relative;
    overflow: hidden;
}

.cell_output::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.6s ease;
}

.cell_output:hover::before {
    left: 100%;
}

.cell_output:hover {
    transform: translateY(-4px) scale(1.01);
    box-shadow: 0 12px 40px rgba(16, 185, 129, 0.3),
                0 6px 20px rgba(0, 0, 0, 0.1);
}

/* ========== 按钮样式 ========== */
/* 排除头部按钮的全局按钮样式 */
.btn:not(.bd-header .btn):not(.bd-navbar .btn),
.bd-button:not(.bd-header .bd-button):not(.bd-navbar .bd-button) {
    background: white !important;
    border: none !important;
    border-radius: 10px !important;
    color: var(--primary-color) !important;
    padding: 0.6rem 1.2rem !important;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    position: relative !important;
    overflow: hidden !important;
    box-shadow: 0 4px 15px var(--shadow-blue) !important;
    font-weight: 500 !important;
}

.btn:not(.bd-header .btn):not(.bd-navbar .btn)::before,
.bd-button:not(.bd-header .bd-button):not(.bd-navbar .bd-button)::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.6s ease;
}

.btn:not(.bd-header .btn):not(.bd-navbar .btn):hover::before,
.bd-button:not(.bd-header .bd-button):not(.bd-navbar .bd-button):hover::before {
    left: 100%;
}

.btn:not(.bd-header .btn):not(.bd-navbar .btn):hover,
.bd-button:not(.bd-header .bd-button):not(.bd-navbar .bd-button):hover {
    background: var(--primary-color) !important;
    color: white !important;
    transform: translateY(-3px) scale(1.05) !important;
    box-shadow: 0 12px 35px var(--shadow-blue-hover) !important;
}

/* 按钮点击动画 */
.btn:not(.bd-header .btn):not(.bd-navbar .btn):active,
.bd-button:not(.bd-header .bd-button):not(.bd-navbar .bd-button):active {
    transform: translateY(-1px) scale(1.02) !important;
    box-shadow: 0 6px 20px var(--shadow-blue) !important;
}

/* ========== 链接样式 ========== */
a {
    color: var(--primary-color) !important;
    text-decoration: none !important;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    position: relative !important;
}

a::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--gradient-blue);
    transition: width 0.3s ease;
}

a:hover::after {
    width: 100%;
}

a:hover {
    color: var(--secondary-color) !important;
    text-shadow: 0 0 12px var(--shadow-blue) !important;
    transform: translateY(-1px) !important;
}

/* ========== 标题样式 ========== */
h1, h2, h3, h4, h5, h6 {
    color: var(--secondary-color) !important;
    text-shadow: 0 3px 8px rgba(0, 0, 0, 0.1) !important;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    position: relative !important;
}

h1::before, h2::before, h3::before {
    content: '';
    position: absolute;
    left: -10px;
    top: 50%;
    transform: translateY(-50%);
    width: 4px;
    height: 0;
    background: var(--gradient-blue-deep);
    transition: height 0.3s ease;
    border-radius: 2px;
}

h1:hover::before, h2:hover::before, h3:hover::before {
    height: 70%;
}

h1:hover, h2:hover, h3:hover {
    transform: translateX(8px) !important;
    color: var(--primary-color) !important;
    text-shadow: 0 4px 12px var(--shadow-blue) !important;
}

/* ========== 响应式设计 ========== */
@media (max-width: 768px) {
    .nboutput img,
    .cell_output img {
        max-width: 95% !important;
        margin: 0.5rem auto !important;
    }

    .bd-main .bd-content .bd-article-container {
        padding: 1rem;
    }
}

/* ========== 动画关键帧 ========== */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes pulse {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.05);
    }
}

/* 页面加载动画 */
.bd-article {
    animation: fadeInUp 0.6s ease-out;
}

/* Notebook单元格出现动画 */
.cell {
    animation: fadeInUp 0.4s ease-out;
    margin-bottom: 1.8rem;
}

/* ========== 滚动条样式 ========== */
/* 整体滚动条 */
::-webkit-scrollbar {
    width: 12px;
    height: 12px;
}

/* 滚动条轨道 */
::-webkit-scrollbar-track {
    background: var(--light-blue);
    border-radius: 6px;
}

/* 滚动条滑块 */
::-webkit-scrollbar-thumb {
    background: #6b7280 !important; /* 灰色滑块 */
    border-radius: 6px;
    border: 2px solid var(--light-blue);
    transition: background 0.3s ease;
}

/* 滚动条滑块悬停效果 */
::-webkit-scrollbar-thumb:hover {
    background: #4b5563 !important; /* 深灰色悬停 */
}

/* 侧边栏专用滚动条 */
.bd-sidebar-primary ::-webkit-scrollbar {
    width: 8px;
}

.bd-sidebar-primary ::-webkit-scrollbar-track {
    background: transparent;
}

.bd-sidebar-primary ::-webkit-scrollbar-thumb {
    background: #9ca3af !important; /* 浅灰色滑块 */
    border-radius: 4px;
    border: none;
}

.bd-sidebar-primary ::-webkit-scrollbar-thumb:hover {
    background: #6b7280 !important; /* 深灰色悬停 */
}

/* Firefox 滚动条样式 */
* {
    scrollbar-width: thin;
    scrollbar-color: #6b7280 var(--light-blue);
}

.bd-sidebar-primary * {
    scrollbar-color: #9ca3af transparent;
}

/* ========== 文本溢出处理 ========== */
/* 防止文本超出容器 */
.bd-content {
    word-wrap: break-word !important;
    word-break: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: auto !important;
}

/* API文档和代码文档的文本处理 */
.sig-name,
.sig-prename,
.highlight .n,
.highlight .na,
.highlight .nb,
.highlight .nc,
.highlight .no,
.highlight .nd,
.highlight .ni,
.highlight .ne,
.highlight .nf,
.highlight .nl,
.highlight .nn,
.highlight .nt,
.highlight .nv {
    word-wrap: break-word !important;
    word-break: break-all !important;
    overflow-wrap: break-word !important;
}

/* 函数签名和参数的处理 */
.sig-param {
    word-wrap: break-word !important;
    word-break: break-all !important;
    overflow-wrap: break-word !important;
    max-width: 100% !important;
    display: inline-block !important;
}

/* 代码块内的长行处理 */
.highlight pre,
.highlight code,
pre,
code {
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    word-break: break-all !important;
    overflow-wrap: break-word !important;
    max-width: 100% !important;
    overflow-x: auto !important;
    scrollbar-width: thin !important;
}

/* 表格内容的处理 - 修复表格显示问题 */
.bd-article-container table {
    table-layout: auto !important;
    width: 100% !important;
    max-width: none !important;
    overflow-x: visible !important;
    display: table !important; /* 修复：保持正常表格显示 */
    white-space: normal !important; /* 修复：允许正常换行 */
    border-collapse: collapse !important;
}

.bd-article-container table td,
.bd-article-container table th {
    word-wrap: break-word !important;
    word-break: break-word !important;
    overflow-wrap: break-word !important;
    max-width: none !important; /* 修复：移除最大宽度限制 */
    overflow: visible !important; /* 修复：允许内容正常显示 */
    text-overflow: clip !important; /* 修复：不裁剪文本 */
    vertical-align: top !important;
    padding: 8px !important;
}

/* 长URL和链接的处理 */
a[href] {
    word-wrap: break-word !important;
    word-break: break-all !important;
    overflow-wrap: break-word !important;
    max-width: 100% !important;
}

/* 文档标题和标签的处理 */
.sig-prename,
.descname {
    word-wrap: break-word !important;
    word-break: break-all !important;
    overflow-wrap: break-word !important;
    max-width: 100% !important;
}

/* 参数列表的处理 */
.field-list,
.field-list .field-name,
.field-list .field-body {
    word-wrap: break-word !important;
    word-break: break-word !important;
    overflow-wrap: break-word !important;
    max-width: 100% !important;
}

/* Notebook单元格内容的特殊处理 */
.nbinput .highlight pre,
.nboutput .highlight pre,
.cell_input .highlight pre,
.cell_output .highlight pre {
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    word-break: break-all !important;
    overflow-wrap: break-word !important;
    max-width: 100% !important;
    overflow-x: auto !important;
    scrollbar-width: thin !important;
    scrollbar-color: var(--primary-color) var(--light-blue) !important;
}

/* 内联代码的处理 */
code {
    white-space: normal !important;
    word-wrap: break-word !important;
    word-break: break-all !important;
    overflow-wrap: break-word !important;
    background-color: #f8fafc !important;
    padding: 2px 4px !important;
    border-radius: 4px !important;
    border: 1px solid var(--light-blue) !important;
}

/* 警告和提示框的文本处理 */
.admonition,
.attention,
.caution,
.danger,
.error,
.hint,
.important,
.note,
.seealso,
.tip,
.warning {
    word-wrap: break-word !important;
    word-break: break-word !important;
    overflow-wrap: break-word !important;
    max-width: 100% !important;
    overflow: hidden !important;
}

/* 修复API文档中的长函数名 */
.signature {
    word-wrap: break-word !important;
    word-break: break-all !important;
    overflow-wrap: break-word !important;
    white-space: pre-wrap !important;
    max-width: 100% !important;
    overflow-x: auto !important;
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%) !important;
    padding: 10px !important;
    border-radius: 6px !important;
    border-left: 4px solid var(--primary-color) !important;
    margin: 10px 0 !important;
}

/* 响应式表格 */
.table-responsive {
    display: block !important;
    width: 100% !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
}

/* 确保容器不会超出视口 */
.bd-article-container,
.bd-content,
.bd-main {
    max-width: 100% !important;
    overflow-x: hidden !important;
}

/* 移动设备上的特殊处理 */
@media (max-width: 768px) {
    table td,
    table th {
        max-width: 120px !important;
        font-size: 0.9em !important;
    }

    .signature {
        font-size: 0.8em !important;
        padding: 8px !important;
    }

    code {
        font-size: 0.85em !important;
        padding: 1px 3px !important;
    }
}

/* 下拉菜单样式 - 确保子按钮宽度一致 */
.article-header-buttons .dropdown-menu {
    z-index: 1050 !important;
    position: absolute !important;
    background: white !important;
    border: none !important;
    border-radius: 8px !important;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15) !important;
    min-width: 120px !important;
    overflow: visible !important;
    padding: 0.5rem 0 !important;
}

.article-header-buttons .dropdown-item {
    color: var(--primary-color) !important;
    padding: 0.5rem 1rem !important;
    transition: all 0.3s ease !important;
    display: block !important;
    width: 100% !important;
    text-align: left !important;
    white-space: nowrap !important;
    border: none !important;
    background: none !important;
}

.article-header-buttons .dropdown-item:hover {
    background: var(--light-blue) !important;
    color: var(--secondary-color) !important;
}

/* 确保下拉按钮容器不会被截断 */
.bd-header .navbar-nav,
.bd-header .nav-item,
.dropdown {
    overflow: visible !important;
    height: auto !important;
}

/* ========== Dark模式支持 ========== */
/* Dark模式下的主题颜色配置 */
[data-theme="dark"] {
    --primary-color: #60a5fa;      /* 浅蓝色主色调 */
    --secondary-color: #3b82f6;    /* 中蓝色 */
    --accent-color: #1d4ed8;       /* 深蓝色 */
    --light-blue: #1e293b;         /* 深色背景 */
    --dark-blue: #0f172a;          /* 更深的背景 */
    --gradient-blue: linear-gradient(135deg, #1e293b, #334155);
    --gradient-blue-deep: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
    --gradient-blue-light: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
    --shadow-blue: rgba(96, 165, 250, 0.2);
    --shadow-blue-light: rgba(96, 165, 250, 0.1);
    --shadow-blue-hover: rgba(96, 165, 250, 0.3);
}

/* Dark模式下的页面整体样式 */
[data-theme="dark"] .bd-main .bd-content .bd-article-container {
    background: var(--gradient-blue-light) !important;
    color: #e2e8f0 !important;
}

/* Dark模式下的导航栏样式 */
[data-theme="dark"] .bd-header {
    background: var(--gradient-blue-deep) !important;
    border-bottom: 3px solid var(--dark-blue) !important;
}

/* Dark模式下的侧边栏样式 */
[data-theme="dark"] .bd-sidebar-primary {
    background: var(--gradient-blue-light) !important;
    border-right: 3px solid #334155 !important;
}

[data-theme="dark"] .bd-sidebar-primary::before {
    background: #334155 !important;
}

/* Dark模式下的侧边栏文字颜色 */
[data-theme="dark"] .bd-sidebar-primary,
[data-theme="dark"] .bd-sidebar-primary a,
[data-theme="dark"] .bd-sidebar-primary .toctree-l1 > a,
[data-theme="dark"] .bd-sidebar-primary .toctree-l2 > a,
[data-theme="dark"] .bd-sidebar-primary .caption,
[data-theme="dark"] .bd-sidebar-primary .caption-text,
[data-theme="dark"] .bd-sidebar-primary li,
[data-theme="dark"] .bd-sidebar-primary p,
[data-theme="dark"] .bd-sidebar-primary span {
    color: #e2e8f0 !important;
}

/* Dark模式下的代码块样式 */
[data-theme="dark"] .nbinput .highlight pre,
[data-theme="dark"] .nboutput .highlight pre,
[data-theme="dark"] .cell_input .highlight pre,
[data-theme="dark"] .cell_output .highlight pre {
    background: linear-gradient(135deg, #1e293b 0%, #334155 100%) !important;
    color: #e2e8f0 !important;
}

/* Dark模式下的输入单元格 */
[data-theme="dark"] .cell_input {
    background: var(--gradient-blue-light) !important;
    border-left: 4px solid var(--primary-color) !important;
}

/* Dark模式下的输出单元格 */
[data-theme="dark"] .cell_output {
    background: linear-gradient(135deg, #134e4a 0%, #1f2937 50%, #374151 100%) !important;
    border-left: 4px solid #10b981 !important;
}

/* Dark模式下的标题样式 */
[data-theme="dark"] h1,
[data-theme="dark"] h2,
[data-theme="dark"] h3,
[data-theme="dark"] h4,
[data-theme="dark"] h5,
[data-theme="dark"] h6 {
    color: #f1f5f9 !important;
}

/* Dark模式下的链接样式 */
[data-theme="dark"] a {
    color: var(--primary-color) !important;
}

/* Dark模式下的按钮样式 */
[data-theme="dark"] .btn:not(.bd-header .btn):not(.bd-navbar .btn),
[data-theme="dark"] .bd-button:not(.bd-header .bd-button):not(.bd-navbar .bd-button) {
    background: #374151 !important;
    color: #e2e8f0 !important;
    border: 1px solid #4b5563 !important;
}

[data-theme="dark"] .btn:not(.bd-header .btn):not(.bd-navbar .btn):hover,
[data-theme="dark"] .bd-button:not(.bd-header .bd-button):not(.bd-navbar .bd-button):hover {
    background: var(--primary-color) !important;
    color: #1e293b !important;
}

/* Dark模式下的下拉菜单样式 */
[data-theme="dark"] .article-header-buttons .dropdown-menu {
    background: #374151 !important;
    border: 1px solid #4b5563 !important;
}

[data-theme="dark"] .article-header-buttons .dropdown-item {
    color: #e2e8f0 !important;
}

[data-theme="dark"] .article-header-buttons .dropdown-item:hover {
    background: #4b5563 !important;
    color: var(--primary-color) !important;
}

/* Dark模式下的图片样式 */
[data-theme="dark"] .nboutput img,
[data-theme="dark"] .cell_output img {
    border: 3px solid #4b5563 !important;
    background: var(--gradient-blue-light) !important;
}

[data-theme="dark"] img:not(.nboutput img):not(.cell_output img):not(.bd-header img):not(.bd-sidebar img),
[data-theme="dark"] .bd-content img,
[data-theme="dark"] .bd-article img,
[data-theme="dark"] article img,
[data-theme="dark"] .document img {
    border: 3px solid #4b5563 !important;
    background: var(--gradient-blue-light) !important;
}

/* Dark模式下的滚动条样式 */
[data-theme="dark"] ::-webkit-scrollbar-track {
    background: #1e293b !important;
}

[data-theme="dark"] ::-webkit-scrollbar-thumb {
    background: #4b5563 !important;
    border: 2px solid #1e293b !important;
}

[data-theme="dark"] ::-webkit-scrollbar-thumb:hover {
    background: #6b7280 !important;
}

/* Dark模式下的Firefox滚动条 */
[data-theme="dark"] * {
    scrollbar-color: #4b5563 #1e293b !important;
}

/* Dark模式下的内联代码 */
[data-theme="dark"] code {
    background-color: #374151 !important;
    color: #e2e8f0 !important;
    border: 1px solid #4b5563 !important;
}

/* Dark模式下的警告和提示框 */
[data-theme="dark"] .admonition,
[data-theme="dark"] .attention,
[data-theme="dark"] .caution,
[data-theme="dark"] .danger,
[data-theme="dark"] .error,
[data-theme="dark"] .hint,
[data-theme="dark"] .important,
[data-theme="dark"] .note,
[data-theme="dark"] .seealso,
[data-theme="dark"] .tip,
[data-theme="dark"] .warning {
    background: #374151 !important;
    color: #e2e8f0 !important;
    border: 1px solid #4b5563 !important;
}

/* Dark模式下的表格样式 */
[data-theme="dark"] table {
    background: #374151 !important;
    color: #e2e8f0 !important;
}

[data-theme="dark"] table td,
[data-theme="dark"] table th {
    border: 1px solid #4b5563 !important;
    background: #374151 !important;
    color: #e2e8f0 !important;
}

/* Dark模式下的图片说明文字 */
[data-theme="dark"] .figure-caption,
[data-theme="dark"] .caption,
[data-theme="dark"] figcaption {
    color: #94a3b8 !important;
}

/* ========== Last Updated Date Styling ========== */
.last-updated {
    font-size: 0.85em;
    color: var(--pst-color-text-muted);
    margin-top: 2rem;
    padding-top: 1rem;
    border-top: 1px solid var(--pst-color-border);
    text-align: center;
}

.last-updated:before {
    content: "📅 ";
    margin-right: 0.5rem;
}

/* Dark mode support for last updated */
[data-theme="dark"] .last-updated {
    color: var(--pst-color-text-muted);
    border-top-color: var(--pst-color-border);
}

/* Footer last updated styling */
.bd-footer .last-updated {
    border-top: none;
    margin-top: 0;
    padding-top: 0;
    font-size: 0.8em;
}

/* Sphinx last updated styling */
.bd-footer-content .last-updated,
.bd-footer-content div:contains("Last updated"),
.bd-footer-content div[class*="last-updated"] {
    color: var(--pst-color-text-muted);
    font-size: 0.85em;
    margin-top: 0.5rem;
}

/* ========== LaTeX数学公式样式优化 ========== */
/* MathJax公式容器样式 */
.MathJax_Display {
    text-align: center !important;
    margin: 1.5rem 0 !important;
    padding: 1rem !important;
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%) !important;
    border-radius: 12px !important;
    border-left: 4px solid var(--primary-color) !important;
    box-shadow: 0 4px 15px var(--shadow-blue-light) !important;
    transition: all 0.3s ease !important;
    position: relative !important;
    overflow: hidden !important;
}

.MathJax_Display:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 8px 25px var(--shadow-blue) !important;
}

/* MathJax行内公式样式 */
.MathJax {
    font-size: 1.1em !important;
    color: var(--secondary-color) !important;
    transition: all 0.3s ease !important;
}

.MathJax:hover {
    color: var(--primary-color) !important;
    transform: scale(1.05) !important;
}

/* MathJax SVG样式 */
.MathJax_SVG {
    color: var(--secondary-color) !important;
    transition: all 0.3s ease !important;
}

.MathJax_SVG:hover {
    color: var(--primary-color) !important;
    filter: drop-shadow(0 2px 8px var(--shadow-blue)) !important;
}

/* 数学公式区块样式 */
.math {
    font-size: 1.1em !important;
    color: var(--secondary-color) !important;
    margin: 0.5rem 0 !important;
    padding: 0.2rem 0.4rem !important;
    background: rgba(37, 99, 235, 0.05) !important;
    border-radius: 4px !important;
    transition: all 0.3s ease !important;
}

.math:hover {
    background: rgba(37, 99, 235, 0.1) !important;
    transform: scale(1.02) !important;
}

/* 显示公式容器 */
.math.display {
    display: block !important;
    text-align: center !important;
    margin: 1.5rem 0 !important;
    padding: 1rem !important;
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%) !important;
    border-radius: 12px !important;
    border-left: 4px solid var(--primary-color) !important;
    box-shadow: 0 4px 15px var(--shadow-blue-light) !important;
    transition: all 0.3s ease !important;
    position: relative !important;
    overflow: hidden !important;
}

.math.display::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--gradient-blue-deep);
    transform: scaleY(0);
    transform-origin: bottom;
    transition: transform 0.3s ease;
}

.math.display:hover::before {
    transform: scaleY(1);
}

.math.display:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px var(--shadow-blue);
}

/* 特定的数学符号和公式优化 */
.math .mfrac {
    margin: 0.2rem 0 !important;
}

.math .msub,
.math .msup {
    font-size: 0.8em !important;
}

.math .mroot {
    margin: 0.1rem 0 !important;
}

/* 数学公式编号样式 */
.eqno {
    float: right !important;
    margin-right: 1rem !important;
    color: var(--primary-color) !important;
    font-weight: 600 !important;
    background: rgba(37, 99, 235, 0.1) !important;
    padding: 0.2rem 0.6rem !important;
    border-radius: 15px !important;
    transition: all 0.3s ease !important;
}

.eqno:hover {
    background: rgba(37, 99, 235, 0.2) !important;
    transform: scale(1.05) !important;
}

/* Dark模式下的数学公式样式 */
[data-theme="dark"] .MathJax_Display {
    background: linear-gradient(135deg, #1e293b 0%, #334155 100%) !important;
    border-left: 4px solid var(--primary-color) !important;
    box-shadow: 0 4px 15px rgba(96, 165, 250, 0.2) !important;
}

[data-theme="dark"] .MathJax,
[data-theme="dark"] .MathJax_SVG {
    color: #e2e8f0 !important;
}

[data-theme="dark"] .MathJax:hover,
[data-theme="dark"] .MathJax_SVG:hover {
    color: var(--primary-color) !important;
}

[data-theme="dark"] .math {
    color: #e2e8f0 !important;
    background: rgba(96, 165, 250, 0.1) !important;
}

[data-theme="dark"] .math:hover {
    background: rgba(96, 165, 250, 0.2) !important;
}

[data-theme="dark"] .math.display {
    background: linear-gradient(135deg, #1e293b 0%, #334155 100%) !important;
    border-left: 4px solid var(--primary-color) !important;
    box-shadow: 0 4px 15px rgba(96, 165, 250, 0.2) !important;
}

[data-theme="dark"] .eqno {
    color: var(--primary-color) !important;
    background: rgba(96, 165, 250, 0.15) !important;
}

[data-theme="dark"] .eqno:hover {
    background: rgba(96, 165, 250, 0.25) !important;
}

/* 数学公式的无障碍访问优化 */
.MathJax_Display[aria-hidden="false"],
.MathJax[aria-hidden="false"] {
    outline: 2px solid transparent !important;
    outline-offset: 2px !important;
    transition: outline-color 0.3s ease !important;
}

.MathJax_Display[aria-hidden="false"]:focus,
.MathJax[aria-hidden="false"]:focus {
    outline-color: var(--primary-color) !important;
}

/* 数学公式中的特殊字符优化 */
.math .mo {
    padding: 0 0.1em !important;
}

.math .mn {
    color: #d97706 !important;
    font-weight: 600 !important;
}

.math .mi {
    color: var(--secondary-color) !important;
    font-style: italic !important;
}

[data-theme="dark"] .math .mn {
    color: #fbbf24 !important;
}

[data-theme="dark"] .math .mi {
    color: #93c5fd !important;
}

/* 改进MathJax渲染质量 */
.MathJax_Display svg,
.MathJax svg {
    shape-rendering: geometricPrecision !important;
    text-rendering: optimizeLegibility !important;
    image-rendering: optimizeQuality !important;
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
}

/* 数学公式的加载动画 */
.MathJax_Display.MathJax_Processing,
.MathJax.MathJax_Processing {
    opacity: 0.7 !important;
    transition: opacity 0.3s ease !important;
}

.MathJax_Display.MathJax_Processing::after,
.MathJax.MathJax_Processing::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    margin: -10px 0 0 -10px;
    border: 2px solid var(--primary-color);
    border-radius: 50%;
    border-top-color: transparent;
    animation: mathLoading 1s linear infinite;
}

@keyframes mathLoading {
    to {
        transform: rotate(360deg);
    }
}

/* 响应式数学公式 */
@media (max-width: 768px) {
    .MathJax_Display {
        margin: 1rem 0 !important;
        padding: 0.8rem !important;
        font-size: 0.9em !important;
    }

    .MathJax {
        font-size: 1em !important;
    }

    .math.display {
        margin: 1rem 0 !important;
        padding: 0.8rem !important;
        font-size: 0.9em !important;
    }
}

/* 数学公式的选择样式 */
.MathJax_Display::selection,
.MathJax::selection {
    background: rgba(37, 99, 235, 0.2) !important;
    color: inherit !important;
}

.MathJax_Display::-moz-selection,
.MathJax::-moz-selection {
    background: rgba(37, 99, 235, 0.2) !important;
    color: inherit !important;
}

[data-theme="dark"] .MathJax_Display::selection,
[data-theme="dark"] .MathJax::selection,
[data-theme="dark"] .MathJax_Display::-moz-selection,
[data-theme="dark"] .MathJax::-moz-selection {
    background: rgba(96, 165, 250, 0.3) !important;
    color: inherit !important;
}

/* ========== Enhanced Button Styles ========== */

/* ========== Header Logo/Title Click to Home ========== */
/* 左上角标题点击回到首页功能 */
.bd-header .navbar-brand,
.bd-header .navbar-brand:hover,
.bd-header .navbar-brand:focus,
.bd-header .navbar-brand:active {
    color: white !important;
    text-decoration: none !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
}

/* 点击效果 */
.bd-header .navbar-brand:hover {
    transform: scale(1.05) !important;
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.8) !important;
}

/* 添加JavaScript功能，让标题点击回到首页 */
.bd-header .navbar-brand {
    position: relative;
}

.bd-header .navbar-brand::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 0;
    height: 2px;
    background: white;
    transition: width 0.3s ease;
}

.bd-header .navbar-brand:hover::after {
    width: 100%;
}

/* 确保标题可点击 */
.bd-header .navbar-brand {
    pointer-events: auto !important;
}

/* 标题文字样式增强 */
.bd-header .navbar-brand .navbar-text {
    color: white !important;
    font-weight: 600 !important;
    letter-spacing: 0.5px !important;
}

/* Logo图片样式 - 增强悬停和点击效果 */
.bd-header .navbar-brand img,
.bd-sidebar-primary .navbar-brand img,
.navbar-brand img {
    cursor: pointer !important;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    border-radius: 8px !important;
}

.bd-header .navbar-brand img:hover,
.bd-sidebar-primary .navbar-brand img:hover,
.navbar-brand img:hover {
    transform: scale(1.02) translateY(-2px) !important;
    filter: drop-shadow(0 1px 3px rgba(59, 130, 246, 0.3)) !important;
    animation: logoGlow 0.6s ease-in-out !important;
}

.bd-header .navbar-brand img:active,
.bd-sidebar-primary .navbar-brand img:active,
.navbar-brand img:active {
    transform: scale(0.95) !important;
    transition: transform 0.1s ease !important;
}

/* 确保logo链接也可点击 */
.bd-header .navbar-brand,
.bd-sidebar-primary .navbar-brand,
.navbar-brand {
    cursor: pointer !important;
    transition: all 0.3s ease !important;
}

.bd-header .navbar-brand:hover,
.bd-sidebar-primary .navbar-brand:hover,
.navbar-brand:hover {
    transform: scale(1.05) !important;
}

/* Logo发光动画 - 渐变色光晕 */
@keyframes logoGlow {
    0%, 100% {
        box-shadow: 0 0 0 rgba(59, 130, 246, 0),
                    0 0 0 rgba(147, 197, 253, 0);
    }
    50% {
        box-shadow: 0 0 2px rgba(59, 130, 246, 0.6),
                    0 0 4px rgba(147, 197, 253, 0.3);
    }
}

/* Logo点击涟漪动画 */
@keyframes ripple {
    to {
        transform: scale(1.5);
        opacity: 0;
    }
}

/* 强制logo可点击样式 */
.logo-clickable,
.logo-clickable img {
    cursor: pointer !important;
}

/* 响应式标题样式 */
@media (max-width: 768px) {
    .bd-header .navbar-brand {
        font-size: 1.1rem !important;
    }
}

/* ========== Copy Button Fix ========== */
/* Fix copy button positioning issues */
button.copybtn {
    position: absolute !important;
    top: .3em !important;
    right: .3em !important;
    z-index: 10 !important;  /* Ensure button stays on top */
    opacity: 0 !important;
    transition: opacity 0.3s, border .3s, background-color .3s !important;
}

/* Ensure highlight container has relative positioning */
div.highlight {
    position: relative !important;
}

/* Show the copybutton on hover */
.highlight:hover button.copybtn,
button.copybtn.success {
    opacity: 1 !important;
}

/* Style the copy button */
button.copybtn {
    width: 1.7em !important;
    height: 1.7em !important;
    padding: 0 !important;
    border: #1b1f2426 1px solid !important;
    border-radius: 0.4em !important;
    background-color: #f6f8fa !important;
    color: #57606a !important;
    user-select: none !important;
    outline: none !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
}

button.copybtn:hover {
    background-color: rgb(235, 235, 235) !important;
}

button.copybtn:active {
    background-color: rgb(187, 187, 187) !important;
}

button.copybtn.success {
    border-color: #22863a !important;
    color: #22863a !important;
}

button.copybtn svg {
    stroke: currentColor !important;
    width: 1.5em !important;
    height: 1.5em !important;
    padding: 0.1em !important;
}

/* Hide copy button when printing */
@media print {
    button.copybtn {
        display: none !important;
    }
}

/* ========== 表格显示修复 ========== */
/* 修复表格被裁剪的问题 */
.bd-main .bd-content .bd-article-container {
    overflow: visible !important; /* 允许内容溢出显示 */
}

/* 确保表格容器可以水平滚动 */
.bd-article {
    overflow-x: auto !important;
}

/* 表格样式增强 */
table {
    width: 100% !important;
    max-width: none !important;
    border-collapse: collapse !important;
    margin: 1rem 0 !important;
    background: white !important;
    border-radius: 8px !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
}

/* 表格单元格样式 */
table th,
table td {
    padding: 12px 16px !important;
    border: 1px solid #e2e8f0 !important;
    text-align: left !important;
    vertical-align: top !important;
    word-wrap: break-word !important;
}

/* 表格头部样式 */
table th {
    background: var(--gradient-blue-light) !important;
    font-weight: 600 !important;
    color: var(--dark-blue) !important;
}

/* 表格行悬停效果 */
table tbody tr:hover {
    background: rgba(37, 99, 235, 0.05) !important;
    transition: background-color 0.2s ease !important;
}

/* 响应式表格 */
@media (max-width: 768px) {
    table {
        font-size: 0.9rem !important;
    }

    table th,
    table td {
        padding: 8px 12px !important;
    }
}

/* 表格容器确保完整显示 */
.table-responsive,
.docutils,
.table-wrapper {
    overflow-x: auto !important;
    width: 100% !important;
    max-width: 100% !important;
}
